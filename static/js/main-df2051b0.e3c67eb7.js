"use strict";(self.webpackChunkdexguru=self.webpackChunkdexguru||[]).push([[2951],{43768:(e,a,t)=>{t.d(a,{Z:()=>z});var l=t(30261),i=t(84033),d=t.n(i),s=t(7276),r=t(5868),n=t(74149),o=t(80512),c=t(62979),m=t(39348),u=t(47248),_=t(79480),v=t(94495),b=t(41092),h=t(23664),x=t(28495),p=t(63323),N=t(75825),g=t.n(N),j=t(67396),k=t(73256),f=t(50520),w=t(15941),y=t(60811),C=t(63812),E=t(44190),O=t(54452),P=t(34071),D=t(72438),A=t(46116),I=t(78003),T=t(53325),L=t(2105),S=t(14305),$=t(21939),F=t.n($);let M=function(e){return e.FILLED="Filled",e.CANCELED="Cancelled",e.EXPIRED="Expired",e.ACTIVE="Active",e}({});var R=t(45263);const G=e=>{var a;const t=(0,r.I0)(),{address:l}=(0,n.mA)(),i=(0,E.cd)(),c=(0,n.t_)(),{data:_}=(0,n.py)(),[v,b]=(0,s.useState)(!1),[h,N]=(0,s.useState)(),$=(0,r.v9)((e=>e.tokens.currentToken)),[G,Z]=(0,s.useState)(!1),[X,z]=(0,s.useState)(null),H=(0,r.v9)((e=>e.networksConfig.data)),q=(0,r.v9)((e=>e.tradingApiConfig)),V=null===$||void 0===$?void 0:$.network,Y=(0,A.a7)(i),B=(0,D.k$)(q,null===Y||void 0===Y?void 0:Y.id),J=e.limitOrder.details.data.makerAsset,W=e.limitOrder.details.data.takerAsset,K=e.limitOrder.details.orderHash,Q=e.limitOrder.details.remainingMakerAmount,U=e.limitOrder.details.data.makingAmount,ee=null===B||void 0===B?void 0:B.limit_order[0].address,ae=(0,s.useCallback)((()=>{if(ee&&i){if(!_)return void console.error("signer for getting limit order data was not found");const e=new j.l(_,c);(0,m.RD)(K,i,Q,ee,e).then((e=>N(e))).catch((()=>N(void 0)))}}),[_,c,i,ee,K,Q]);if((0,s.useEffect)((()=>{ae()}),[ae]),!$||!V||!J||!W||!Y||!ee||!i)return null;const te=new(g())(e.limitOrder.details.data.makingAmount).div(10**e.makerToken.decimals),le=new(g())(e.limitOrder.details.data.takingAmount).div(10**e.takerToken.decimals),ie=(null===$||void 0===$?void 0:$.address)===e.makerToken.address?"down":"up",de={className:d()("data-table__trow","data-table__trow--active",`data-table__trow--${ie}`,"data-table__trow--own"),"data-testid":`table-row-${ie}`},se=()=>{Z(!1),z(null)},re=x.LimitOrderDecoder.unpackInteraction(e.limitOrder.details.data,"predicate");if(!re)return null;const ne=function(e,a){var t,l;const i=new x.LimitOrderPredicateDecoder(a).decode(e).args;return i&&1e3*(null===(t=F()(i,"data").args)||void 0===t||null===(l=t.timestamp)||void 0===l?void 0:l.bytes)||null}(re,i);let oe=null;if(ne){const e=(0,f.Mu)(ne,{month:"short",day:"2-digit"}),a=(0,f.Mu)(ne,{hour:"numeric",minute:"numeric"}),t=(0,f.qJ)(ne);oe=(0,R.jsxs)("span",{className:"data-table__data data-table__data--datetime","data-tooltip-html":t,"data-tooltip-id":"app-tooltip",children:[(0,R.jsx)("span",{className:"date",children:e}),(0,R.jsx)("span",{className:"time",children:a})]})}const ce=(0,u.fi)(e.makerToken),me=(0,u.fi)(e.takerToken);let ue=h?100*(1-Number(h)/Number(U)):void 0;const _e=function(e,a,t){var l,i;const d=t.find((e=>"fill"===e.action&&"0"===e.remainingMakerAmount)),s=t.find((e=>"cancel"===e.action));if(d)return M.FILLED;if(s)return M.CANCELED;const r=x.LimitOrderDecoder.unpackInteraction(a.data,"predicate"),n=new x.LimitOrderPredicateDecoder(e).decode(r).args;if(!n)return M.EXPIRED;const o=1e3*(null===(l=F()(n,"data").args)||void 0===l||null===(i=l.timestamp)||void 0===i?void 0:i.bytes)||null;return o&&Date.now()/1e3>o?M.EXPIRED:o&&Date.now()<o&&new(g())(a.remainingMakerAmount).gt(0)?M.ACTIVE:M.EXPIRED}(i,e.limitOrder.details,e.limitOrder.events);_e===M.CANCELED&&(ue=0);const ve=Y.name!==V?((e,a,t)=>[{caption:e?"":"Switch",disabled:e,pending:e,buttonSize:"md",className:"button--accept",onClick:a},{caption:"Don't Switch",disabled:e,buttonSize:"md",className:"button--decline",onClick:t}])(v,(async()=>{b(!0),await(0,y.Z)(V),b(!1),Z(!1)}),se):((e,a,t)=>[{caption:e?"":"Cancel Order",disabled:e,pending:e,buttonSize:"md",className:"button--accept",onClick:a},{caption:"Don't Cancel",disabled:e,buttonSize:"md",className:"button--decline",onClick:t}])(v,(async()=>{if(b(!0),z(null),!_)return void console.error("signer for limit order was not found");const a=new j.l(_,c);if(!ee)return void console.error("limitOrderProviderAddress was not found");const d=new x.LimitOrderProtocolFacade(ee,i,a).cancelLimitOrder(e.limitOrder.details.data),{gasPrice:s,error:r}=await(0,I.o3)(V);if(!s||r){const e="Error during getting gas price for limit order";return console.error(e,r),z(e),void b(!1)}const n=(0,C.ot)(s,O.GasFeeType.fast),m={account:l,to:ee,data:d,maxFeePerGas:void 0,maxPriorityFeePerGas:void 0,gasPrice:void 0,chain:_.chain};if(Object.prototype.hasOwnProperty.call(n,"maxFeePerGas")){const{maxFeePerGas:e,maxPriorityFeePerGas:a}=n;m.maxFeePerGas=e?BigInt(e):void 0,m.maxPriorityFeePerGas=a?BigInt(a):void 0}else{const{gasPrice:e}=n;m.gasPrice=e?BigInt(e):void 0}try{const e=await _.sendTransaction(m);(0,p.Mn)({hash:e}).then((()=>{l&&null!==$&&void 0!==$&&$.id&&t((0,o.RD)(l,$.id)),P.Z.sendEvent(k.S.LIMIT_ORDER_CANCELED,{token_id:(0,T.hT)(J,V),token_pair:(0,T.hT)(W,V),network:V}),b(!1)}))}catch(r){console.error("Error during canceling limit order",r);const e=(e=>{const a=(e||"MetaMask RPC error").split("[ethjs-query] while formatting outputs from RPC");let t;t=a[1]?`MetaMask RPC error: ${JSON.parse(a[1].replace(/\s'(.*)'/,"$1")).value.data.message}`:a[0];return t})(null===r||void 0===r?void 0:r.message);z(e),b(!1)}}),se),be=Y.name!==V?`Switch to ${(null===(a=(0,T.Or)(V,H))||void 0===a?void 0:a.description)||V} before canceling your limit order?`:"You will be charged a gas fee for manually cancelling your limit order before it  expires. Are you sure you want to cancel it?",he=Y.name!==V?"Wrong Network":"Cancel limit order",xe=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("div",{className:`data-table__tcell data-table__tcell--type data-table__tcell--type-${ie}`}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--amount",children:(0,R.jsxs)("div",{className:"data-table__data",children:[(0,R.jsx)("div",{className:"value",title:(0,w.G$)(te),children:(0,R.jsx)("span",{className:d()("number",{shorten:te.lt(1)}),children:(0,w.G$)(te)})}),(0,R.jsx)("div",{className:"value",title:(0,w.G$)(le),children:(0,R.jsx)("span",{className:d()("number",{shorten:le.lt(1)}),children:(0,w.G$)(le)})})]})}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--token",children:(0,R.jsxs)("div",{className:"data-table__data",children:[(0,R.jsx)("div",{className:"symbol",title:ce,children:(0,R.jsx)("span",{className:"caption shorten",children:ce})}),(0,R.jsx)("div",{className:"symbol",title:me,children:(0,R.jsx)("span",{className:"caption shorten",children:me})})]})}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--expiration",children:oe}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--remaining",children:(0,R.jsx)("div",{className:d()("data-table__data",{sign:!ue}),children:(ue||0===ue)&&`${ue.toFixed()}%`})}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--status",children:(0,R.jsx)("div",{className:"tag",children:_e})}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--action",children:_e===M.ACTIVE&&(0,R.jsx)(L.Z,{size:"sm",onClick:()=>Z(!0),tooltip:"Cancel limit order"})}),G&&(0,R.jsx)(S.Z,{isOpen:!0,title:he,onClose:se,onRequestClose:se,actions:ve,error:X,children:be})]});return(0,s.createElement)("div",{...de,"data-hash":e.limitOrder.details.orderHash,key:e.limitOrder.details.orderHash},xe)};var Z=t(31284);const X=()=>(0,R.jsx)("div",{className:"data-table__thead",children:(0,R.jsxs)("div",{className:"data-table__trow data-table__trow--header",children:[(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--header data-table__tcell--type"}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--header data-table__tcell--amount",children:(0,R.jsx)("span",{className:"caption",children:"Pay/Receive"})}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--header data-table__tcell--token"}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--header data-table__tcell--expiration",children:(0,R.jsx)("span",{className:"caption",children:"Expiration"})}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--header data-table__tcell--remaining"}),(0,R.jsxs)("div",{className:"data-table__tcell data-table__tcell--header data-table__tcell--status",children:[(0,R.jsx)("span",{className:"caption",children:"Status"}),(0,R.jsx)(Z.e,{tooltip:"Sometimes your limit order is only partially filled. This is why there is a percentage next to the status."})]}),(0,R.jsx)("div",{className:"data-table__tcell data-table__tcell--header data-table__tcell--action"})]})}),z=()=>{const e=(0,r.I0)(),{address:a}=(0,n.mA)(),t=(0,r.v9)((e=>e.tokens.currentToken)),i=(0,r.v9)((e=>e.tokens.tokens)),{isLoading:x,limitOrders:p}=(0,r.v9)((e=>e.limitOrders)),N=(0,s.useCallback)((()=>{a&&null!==t&&void 0!==t&&t.id&&e((0,o.RD)(a,t.id))}),[a,null===t||void 0===t?void 0:t.id,e]);(0,s.useEffect)((()=>{N()}),[a,null===t||void 0===t?void 0:t.id,N]),(0,s.useEffect)((()=>{if(!p||null===t||void 0===t||!t.id)return;const a=(0,m.yy)(p,t.id),l=(0,u.Vy)(a,i);l.length>0&&e((0,c.Zu)(l))}),[p,i,null===t||void 0===t?void 0:t.id,e]);const g=x?h.XH.loading:`No active limit orders with ${(0,u.fi)(t)}. Try choosing a different token inside Market Selector`;return t?(0,R.jsx)("div",{className:"limit-orders",children:(0,R.jsxs)("div",{className:"data-table data-table--compact data-table--limits",children:[(0,R.jsxs)("div",{className:"data-table__header",children:[(0,R.jsxs)(v.X,{size:"xs",className:"data-table__title",children:["My ",(0,u.fi)(t)," Limit Orders"]}),(0,R.jsx)("div",{className:"data-table__actions",children:(0,R.jsx)(_.ZP,{className:d()("button--xs data-table__reload",{loading:x}),disabled:x,icon:(0,R.jsx)(l.r,{}),onClick:N})})]}),(0,R.jsxs)("div",{className:"data-table__body",children:[x&&(0,R.jsx)("div",{className:"data-table__nodata",children:(0,R.jsx)("div",{className:"text",children:h.XH.loading})}),!x&&!(null!==p&&void 0!==p&&p.length)&&(0,R.jsx)(b.Z,{text:g,type:"empty",icon:b.C.warning,isShowMascot:!1}),!x&&!(null===p||void 0===p||!p.length)&&(0,R.jsxs)("div",{className:"data-table__table data-table__table--compact data-table__table--limits",children:[(0,R.jsx)(X,{}),(0,R.jsx)("div",{className:"data-table__tbody",children:!(null===p||void 0===p||!p.length)&&p.map((e=>{const a=i.find((a=>a.id===`${e.details.data.makerAsset.toLowerCase()}-${t.network}`)),l=i.find((a=>a.id===`${e.details.data.takerAsset.toLowerCase()}-${t.network}`));return a&&l?(0,R.jsx)(G,{limitOrder:e,takerToken:l,makerToken:a},e.details.signature):null}))})]})]})]})}):null}},28830:(e,a,t)=>{t.d(a,{YP:()=>i,Ib:()=>d,YM:()=>s,rR:()=>r,ww:()=>n});var l=t(46116);const i="Slippage is a difference between the quoted price and the executed price of your trade.",d="You can execute trades with high slippage only if you allow it in DexGuru Settings \u2699\ufe0f",s=[{id:0,value:.5},{id:1,value:1},{id:2,value:3}],r=(e,a)=>100*(Number(null===e||void 0===e?void 0:e.toFixed())||0)/Number((null===a||void 0===a?void 0:a.toFixed())||0)>25,n=e=>`${(0,l.Mo)(e).description} Network Fee`},49241:(e,a,t)=>{t.d(a,{Z:()=>u});var l=t(6007),i=(t(75933),t(36649),t(27227),t(75451),t(46873),t(737),t(84033)),d=t.n(i),s=t(7276),r=t(5868),n=t(30839),o=t(51187),c=t(94235),m=t(45263);const u=e=>{let{modifier:a,onTimeout:t,isDashboard:i=!0,infinity:u=!1,className:_,style:v}=e;const b=(0,s.useRef)(void 0),h=(0,r.I0)();(0,c.J)((()=>{if(!u)return b.current=setInterval((()=>{h((0,n.iM)(!0,i)),t&&t()}),o.p7),()=>{h((0,n.iM)(!1,!1)),b.current&&clearInterval(b.current),b.current=void 0}}));let x=(0,m.jsx)(l.r,{});return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:d()("loader-guru",{[`loader-guru--${a}`]:a},_),style:v,children:(0,m.jsxs)("div",{className:"loader-guru__container",children:[(0,m.jsx)("div",{className:"loader-guru__rainbow",children:(0,m.jsxs)("div",{className:"loader-rainbow",children:[(0,m.jsx)("div",{className:"loader-rainbow__line"}),(0,m.jsx)("div",{className:"loader-rainbow__line"}),(0,m.jsx)("div",{className:"loader-rainbow__line"}),(0,m.jsx)("div",{className:"loader-rainbow__line"}),(0,m.jsx)("div",{className:"loader-rainbow__line"})]})}),(0,m.jsx)("div",{className:"loader-guru__avatar",children:x})]})})})}}}]);